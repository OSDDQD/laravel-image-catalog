tinymce.PluginManager.add('galleryphoto', function(editor, url) {
    // Add a button that opens a window
    editor.addButton('galleryphoto', {
        text: 'Photo',
        icon: "image",
        onclick: function() {
            var cValues = null;
            $.ajax({
                url: '/manager/editor/galleryphotos',
                async: false,
                type: 'post',
                dataType: 'json',
                success: function (output) {
                    cValues = output;
                }
            });
            console.log(cValues);
            // Open window
            editor.windowManager.open({
                title: 'Insert gallery photo',
                body: [
                    {type: 'listbox', name: 'galleryphoto', text: 'Photo', icon: false, values: cValues}
                ],
                onsubmit: function(e) {
                    // Insert content when the window form is submitted
                    editor.insertContent("[galleryphoto id='" + e.data.galleryphoto + "']");
                }
            });
        }
    });
});